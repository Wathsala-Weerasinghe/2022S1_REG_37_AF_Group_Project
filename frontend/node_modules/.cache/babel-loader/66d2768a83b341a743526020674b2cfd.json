{"ast":null,"code":"var _jsxFileName = \"/Users/kethmi/Desktop/assignment/2022S1_REG_37_AF_Group_Project/frontend/src/pages/Booking.js\";\nimport React from \"react\";\nimport axios from 'axios';\nimport moviedefault from '../images/movie-default.png';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nclass Booking extends React.Component {\n  constructor() {\n    super();\n    this.state = {\n      tableData: [],\n      theaterData: [],\n      movieData: []\n    };\n  }\n\n  componentDidMount() {\n    if (this.first) return;\n    this.first = true;\n    var token = sessionStorage.getItem('token');\n    axios.get(`http://localhost:3022/ticket-bundles`, {\n      headers: {\n        'Authorization': token\n      }\n    }).then(response => {\n      this.setState(prevState => {\n        let tableData = { ...prevState.tableData\n        };\n        tableData = response.data;\n        return {\n          tableData\n        };\n      });\n    }).catch(function (error) {\n      console.log(error);\n    });\n    axios.get(`http://localhost:3022/theaters`, {\n      headers: {\n        'Authorization': token\n      }\n    }).then(response => {\n      this.setState(prevState => {\n        let theaterData = { ...prevState.theaterData\n        };\n        theaterData = response.data;\n        return {\n          theaterData\n        };\n      });\n    }).catch(function (error) {\n      console.log(error);\n    });\n    axios.get(`http://localhost:3022/movies`, {\n      headers: {\n        'Authorization': token\n      }\n    }).then(response => {\n      this.setState(prevState => {\n        let movieData = { ...prevState.movieData\n        };\n        movieData = response.data;\n        return {\n          movieData\n        };\n      });\n    }).catch(function (error) {\n      console.log(error);\n    });\n  }\n\n  getTheaterName(id) {\n    var theater = this.state.theaterData.filter(val => val._id === id);\n\n    if (theater.length === 1) {\n      return theater[0].name;\n    }\n\n    return 'N/A';\n  }\n\n  getMovieName(id) {\n    var movie = this.state.movieData.filter(val => val._id === id);\n\n    if (movie.length === 1) {\n      return movie[0].name;\n    }\n\n    return 'N/A';\n  }\n\n  getItemCount(cart) {\n    let itemCount = 0;\n\n    if (cart) {\n      cart.forEach(function (item) {\n        itemCount += 1;\n      });\n    }\n\n    return itemCount;\n  }\n\n  addToCart(id, moviename, theatername) {\n    let cart = sessionStorage.getItem('cart');\n\n    if (!cart) {\n      cart = [];\n    } else {\n      cart = JSON.parse(cart);\n    }\n\n    var itemInCart = cart.filter(val => val.id === id);\n\n    if (itemInCart.length === 1) {\n      alert('item already added!');\n    } else {\n      cart.push({\n        id: id,\n        movie: moviename,\n        theater: theatername,\n        count: 1\n      });\n      sessionStorage.setItem('cart', JSON.stringify(cart));\n      document.getElementById('cart-item-count').innerHTML = '[' + this.getItemCount(cart) + ']';\n    }\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"Book a movie\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 125,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"hr\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 126,\n        columnNumber: 13\n      }, this), this.state.tableData.map(item => /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"card item-card\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"movie-name\",\n          children: this.getMovieName(item.movieid)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 129,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"center\", {\n          children: /*#__PURE__*/_jsxDEV(\"img\", {\n            className: \"movie-banner\",\n            src: moviedefault\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 130,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 130,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"theater-name\",\n          children: this.getTheaterName(item.theaterid)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 131,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"hr\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 132,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"ticket-count\",\n          children: [\"Available: \", item.availableticketcount, \" tickets\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 133,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"hr\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 134,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"button\",\n          className: \"btn btn-primary\",\n          onClick: this.addToCart.bind(this, item._id, this.getMovieName(item.movieid), this.getTheaterName(item.theaterid)),\n          value: \"Add to Cart\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 135,\n          columnNumber: 21\n        }, this)]\n      }, item._id, true, {\n        fileName: _jsxFileName,\n        lineNumber: 128,\n        columnNumber: 17\n      }, this))]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 16\n    }, this);\n  }\n\n}\n\nexport default Booking;","map":{"version":3,"names":["React","axios","moviedefault","Booking","Component","constructor","state","tableData","theaterData","movieData","componentDidMount","first","token","sessionStorage","getItem","get","headers","then","response","setState","prevState","data","catch","error","console","log","getTheaterName","id","theater","filter","val","_id","length","name","getMovieName","movie","getItemCount","cart","itemCount","forEach","item","addToCart","moviename","theatername","JSON","parse","itemInCart","alert","push","count","setItem","stringify","document","getElementById","innerHTML","render","map","movieid","theaterid","availableticketcount","bind"],"sources":["/Users/kethmi/Desktop/assignment/2022S1_REG_37_AF_Group_Project/frontend/src/pages/Booking.js"],"sourcesContent":["import React from \"react\";\r\nimport axios from 'axios';\r\n\r\nimport moviedefault from '../images/movie-default.png';\r\n\r\nclass Booking extends React.Component\r\n{\r\n    constructor () {\r\n        super();\r\n\r\n        this.state = {\r\n            tableData: [],\r\n            theaterData: [],\r\n            movieData: []\r\n        };\r\n    }\r\n\r\n    componentDidMount() {\r\n        if (this.first) return; this.first = true;\r\n\r\n        var token = sessionStorage.getItem('token');\r\n        axios.get(`http://localhost:3022/ticket-bundles`, {\r\n            headers: {\r\n            'Authorization' : token\r\n            }\r\n        })\r\n        .then(response => {\r\n            this.setState(prevState => {\r\n                let tableData = { ...prevState.tableData };\r\n                tableData = response.data;                 \r\n                return { tableData }; \r\n              });\r\n        })\r\n        .catch(function (error) {\r\n            console.log(error);\r\n        });\r\n\r\n        axios.get(`http://localhost:3022/theaters`, {\r\n            headers: {\r\n            'Authorization' : token\r\n            }\r\n        })\r\n        .then(response => {\r\n            this.setState(prevState => {\r\n                let theaterData = { ...prevState.theaterData };\r\n                theaterData = response.data;                 \r\n                return { theaterData }; \r\n              });\r\n        })\r\n        .catch(function (error) {\r\n            console.log(error);\r\n        });\r\n\r\n        axios.get(`http://localhost:3022/movies`, {\r\n            headers: {\r\n            'Authorization' : token\r\n            }\r\n        })\r\n        .then(response => {\r\n            this.setState(prevState => {\r\n                let movieData = { ...prevState.movieData };\r\n                movieData = response.data;                 \r\n                return { movieData }; \r\n              });\r\n        })\r\n        .catch(function (error) {\r\n            console.log(error);\r\n        });\r\n    }\r\n\r\n    getTheaterName(id){\r\n        var theater = this.state.theaterData.filter(val => val._id === id);\r\n\r\n        if (theater.length === 1){\r\n            return theater[0].name;\r\n        }\r\n\r\n        return 'N/A';\r\n    }\r\n\r\n    getMovieName(id){\r\n        var movie = this.state.movieData.filter(val => val._id === id);\r\n\r\n        if (movie.length === 1){\r\n            return movie[0].name;\r\n        }\r\n\r\n        return 'N/A';\r\n    }\r\n\r\n    getItemCount(cart){\r\n        let itemCount = 0;\r\n    \r\n        if (cart) {\r\n          cart.forEach(function(item){\r\n            itemCount += 1;\r\n          });\r\n        }\r\n    \r\n        return itemCount;\r\n      }\r\n\r\n    addToCart(id, moviename, theatername){\r\n        let cart = sessionStorage.getItem('cart');\r\n\r\n        if (!cart) {\r\n            cart = [];\r\n        }else{\r\n            cart = JSON.parse(cart);\r\n        }\r\n\r\n        var itemInCart = cart.filter(val => val.id === id);\r\n\r\n        if (itemInCart.length === 1) {\r\n            alert('item already added!');\r\n        }else{\r\n            cart.push({id:id, movie: moviename, theater: theatername, count:1});\r\n            sessionStorage.setItem('cart', JSON.stringify(cart));\r\n            document.getElementById('cart-item-count').innerHTML = '[' + this.getItemCount(cart) + ']';\r\n        }\r\n    }\r\n\r\n    render(){\r\n        return(<div>\r\n            <h2>Book a movie</h2>\r\n            <hr />\r\n            {this.state.tableData.map(item => \r\n                <div className=\"card item-card\" key={item._id}>\r\n                    <span className=\"movie-name\">{this.getMovieName(item.movieid)}</span>\r\n                    <center><img className=\"movie-banner\" src={moviedefault}></img></center>\r\n                    <span className=\"theater-name\">{this.getTheaterName(item.theaterid)}</span>\r\n                    <hr />\r\n                    <span className=\"ticket-count\">Available: {item.availableticketcount} tickets</span>\r\n                    <hr />\r\n                    <input type=\"button\" className=\"btn btn-primary\" \r\n                        onClick={this.addToCart.bind(this, item._id, this.getMovieName(item.movieid), this.getTheaterName(item.theaterid))} value=\"Add to Cart\" />\r\n                </div>\r\n                )}\r\n        </div>);\r\n    }\r\n}\r\n\r\nexport default Booking;"],"mappings":"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"},"metadata":{},"sourceType":"module"}